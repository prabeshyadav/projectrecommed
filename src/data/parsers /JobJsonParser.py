data = """

{"results":[{"absolute_url":"/top-senior-python-dev/","education_program":[],"banner":null,"categories":["Actuary (Insurance)","Administration","Creative / Graphics / Designing","Accounts","Administration","Administration"],"job_service":{"level":1,"service_type":"Premium Job","name":"Top Job"},"offered_salary":{"maximum":null,"minimum":3424324.0,"unit":"Monthly","currency":"$","operator":null},"modified_at":"2018-05-03T05:33:06.323644Z","vacancies":1,"can_apply_from_mobile":false,"job_source":null,"job_locations":[{"city":"Kathmandu","country":"Nepal","address":"Kathmandu, Nepal","latitude":27.7172453,"longitude":85.3239605,"street":"Kathmandu, Nepal"}],"job_level":"Senior Level","deadline":"2018-06-29T14:05:00Z","slug":"top-senior-python-dev","education_level":null,"posted_at":"2018-05-03T05:33:06.315245Z","specification":null,"hide_org_name":false,"skills":[],"logo":{"image":"default_pp/employer/employer.png","url":"/media/default_pp/employer/employer.png"},"apply_online_alternative":"None","industry":"Telecommunication","apply_online":true,"posted_date":"2018-05-03","available_for":["Part Time"],"org_alt_description":"","alternate_description":"<p>None<span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>Nonev</span></p>","title":"Top Senior Python dev","education_description":"None","id":21,"client":{"slug":"aayulogic","client_name":"Aayulogic","id":3},"description":null,"extra_description":"None","np_image":null},{"absolute_url":"/service-engineer-2/","education_program":[],"banner":null,"categories":["Secretarial / Front Office / Data Entry"],"job_service":{"level":2,"service_type":"Premium Job","name":"Hot Job"},"offered_salary":{"maximum":50000.0,"minimum":1000.0,"unit":"Monthly","currency":"NRs","operator":null},"modified_at":"2018-04-26T06:21:10.654613Z","vacancies":10,"can_apply_from_mobile":false,"job_source":null,"job_locations":[{"city":"Kathmandu","country":"Nepal","address":"Kathmandu, Nepal","latitude":27.7172453,"longitude":85.3239605,"street":"Kathmandu, Nepal"}],"job_level":"Entry Level","deadline":"2018-06-14T22:35:00Z","slug":"service-engineer-2","education_level":null,"posted_at":"2018-04-26T06:21:10.653060Z","specification":null,"hide_org_name":false,"skills":[],"logo":{"image":"default_pp/employer/employer.png","url":"/media/default_pp/employer/employer.png"},"apply_online_alternative":"None","industry":"Automotive Sales, Support and Service","apply_online":true,"posted_date":"2018-04-26","available_for":["Full Time"],"org_alt_description":"","alternate_description":"<p>Manage all the staffs</p><p><br></p>","title":"Service Engineer","education_description":"None","id":29,"client":{"slug":"bmw-nepal","client_name":"BMW Nepal","id":5},"description":null,"extra_description":"None","np_image":null},{"absolute_url":"/top-level/","education_program":[{"degree":{"id":1,"name":"Masters"},"status":"Approved","id":1,"name":"Master in Business Studies (MBS)"}],"banner":null,"categories":["Accounting / Finance","Account management"],"job_service":{"level":1,"service_type":"Premium Job","name":"Top Job"},"offered_salary":{"maximum":null,"minimum":25000.0,"unit":"Monthly","currency":"NRs","operator":"Above"},"modified_at":"2018-04-26T07:50:03.228587Z","vacancies":6,"can_apply_from_mobile":false,"job_source":null,"job_locations":[{"city":null,"country":null,"address":"","latitude":null,"longitude":null,"street":null}],"job_level":"Top Level","deadline":"2018-05-31T07:40:00Z","slug":"top-level","education_level":"Masters","posted_at":"2018-04-26T07:50:03.227375Z","specification":"<p>Must have at least 3 years of experience in related field.</p><p>High level of verbal and written communication skills.</p><p>Should have good knowledge of financial statements.</p><p>Good knowledge of accounting software.</p><p>Both Male and Female are preferable</p>","hide_org_name":false,"skills":["Accounting"],"logo":{"image":"default_pp/employer/employer.png","url":"/media/default_pp/employer/employer.png"},"apply_online_alternative":"None","industry":"Automotive Sales, Support and Service","apply_online":true,"posted_date":"2018-04-26","available_for":["Full Time"],"org_alt_description":"","alternate_description":null,"title":"top level","education_description":"None","id":30,"client":{"slug":"bmw-nepal","client_name":"BMW Nepal","id":5},"description":"<br><p>o implement good internal control system, establish key control points and schedule monitoring for control assurance</p><p>Preparing balance sheet, cash flow statement, income statement, other periodic statements</p><p>Maintain general ledger by transferring subsidiary accounts, preparing a trial balance, reconciling entries</p><p>Complete external audit by analyzing and scheduling general ledger accounts; providing information for auditors</p><p>Coordinate with other departments to ensure the payment by the customers</p><p>Maintains professional and technical knowledge by attending educational workshops; reviewing professional publications; establishing personal networks; participating in professional societies</p>","extra_description":"None","np_image":null},{"absolute_url":"/senior-frontend-dev/","education_program":[],"banner":null,"categories":["IT and Telecommunication"],"job_service":{"level":1,"service_type":"Premium Job","name":"Top Job"},"offered_salary":{"maximum":null,"minimum":20000000.0,"unit":"Monthly","currency":"NRs","operator":null},"modified_at":"2018-05-03T05:36:14.848661Z","vacancies":3,"can_apply_from_mobile":false,"job_source":null,"job_locations":[{"city":null,"country":null,"address":"","latitude":null,"longitude":null,"street":null}],"job_level":"Top Level","deadline":"2018-05-24T11:10:00Z","slug":"senior-frontend-dev","education_level":null,"posted_at":"2018-05-03T05:36:14.834194Z","specification":null,"hide_org_name":false,"skills":[],"logo":{"image":"default_pp/employer/employer.png","url":"/media/default_pp/employer/employer.png"},"apply_online_alternative":"None","industry":"Telecommunication","apply_online":true,"posted_date":"2018-05-03","available_for":["Full Time"],"org_alt_description":"","alternate_description":"Nonesad sad dsa das dsa sda sad asda sd asd sad<br>","title":"Senior Frontend Dev","education_description":"None","id":32,"client":{"slug":"aayulogic","client_name":"Aayulogic","id":3},"description":null,"extra_description":"None","np_image":null},{"absolute_url":"/progress11_developer/","education_program":[],"banner":null,"categories":["IT and Telecommunication"],"job_service":{"level":1,"service_type":"Premium Job","name":"Top Job"},"offered_salary":{"maximum":null,"minimum":29155.0,"unit":"Monthly","currency":"NRs","operator":null},"modified_at":"2018-05-03T08:31:55.404651Z","vacancies":6,"can_apply_from_mobile":false,"job_source":null,"job_locations":[{"city":"Kathmandu","country":"Nepal","address":"Lalitpur Nepal","latitude":82.0,"longitude":81.0,"street":"Minbhawan Bus Stop, Kathmandu, Central Region, Nepal, N.K.Singh Marg, Kathmandu, Nepal"}],"job_level":"Senior Level","deadline":"2018-05-30T08:40:00Z","slug":"progress11_developer","education_level":null,"posted_at":"2018-05-03T08:31:55.366559Z","specification":null,"hide_org_name":false,"skills":[],"logo":{"image":"default_pp/employer/employer.png","url":"/media/default_pp/employer/employer.png"},"apply_online_alternative":"None","industry":"Automotive Sales, Support and Service","apply_online":true,"posted_date":"2018-05-03","available_for":["Contract"],"org_alt_description":"","alternate_description":"Perform all related tasks.","title":"Progress11_Developer","education_description":"None","id":151,"client":{"slug":"bmw-nepal","client_name":"BMW Nepal","id":5},"description":null,"extra_description":"None","np_image":null},{"absolute_url":"/test-detail/","education_program":[],"banner":null,"categories":["Creative / Graphics / Designing"],"job_service":{"level":1,"service_type":"Premium Job","name":"Top Job"},"offered_salary":{"maximum":null,"minimum":25000.0,"unit":"Monthly","currency":"NRs","operator":"Above"},"modified_at":"2018-05-04T06:19:49.017099Z","vacancies":5,"can_apply_from_mobile":false,"job_source":null,"job_locations":[{"city":"Kathmandu","country":"Nepal","address":"Kathmandu, Nepal","latitude":27.7172453,"longitude":85.3239605,"street":"Kathmandu, Nepal"}],"job_level":"Senior Level","deadline":"2018-05-22T23:40:00Z","slug":"test-detail","education_level":null,"posted_at":"2018-05-04T06:19:48.988322Z","specification":null,"hide_org_name":false,"skills":[],"logo":{"image":"default_pp/employer/employer.png","url":"/media/default_pp/employer/employer.png"},"apply_online_alternative":"None","industry":"Automotive Sales, Support and Service","apply_online":true,"posted_date":"2018-05-04","available_for":["Full Time"],"org_alt_description":"","alternate_description":"Job description from UI","title":"Test Detail","education_description":"None","id":185,"client":{"slug":"bmw-nepal","client_name":"BMW Nepal","id":5},"description":null,"extra_description":"None","np_image":null}]}


"""

datas = """
{  
   "results":[  
      {  
         "absolute_url":"/top-senior-python-dev/",
         "education_program":[  

         ],
         "banner":null,
         "categories":[  
            "Actuary (Insurance)",
            "Administration",
            "Creative / Graphics / Designing",
            "Accounts",
            "Administration",
            "Administration"
         ],
         "job_service":{  
            "level":1,
            "service_type":"Premium Job",
            "name":"Top Job"
         },
         "offered_salary":{  
            "maximum":null,
            "minimum":3424324.0,
            "unit":"Monthly",
            "currency":"$",
            "operator":null
         },
         "modified_at":"2018-05-03T05:33:06.323644Z",
         "vacancies":1,
         "can_apply_from_mobile":false,
         "job_source":null,
         "job_locations":[  
            {  
               "city":"Kathmandu",
               "country":"Nepal",
               "address":"Kathmandu, Nepal",
               "latitude":27.7172453,
               "longitude":85.3239605,
               "street":"Kathmandu, Nepal"
            }
         ],
         "job_level":"Senior Level",
         "deadline":"2018-06-29T14:05:00Z",
         "slug":"top-senior-python-dev",
         "education_level":null,
         "posted_at":"2018-05-03T05:33:06.315245Z",
         "specification":null,
         "hide_org_name":false,
         "skills":[  

         ],
         "logo":{  
            "image":"default_pp/employer/employer.png",
            "url":"/media/default_pp/employer/employer.png"
         },
         "apply_online_alternative":"None",
         "industry":"Telecommunication",
         "apply_online":true,
         "posted_date":"2018-05-03",
         "available_for":[  
            "Part Time"
         ],
         "org_alt_description":"",
         "alternate_description":"<p>None<span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>None</span><span>Nonev</span></p>",
         "title":"Top Senior Python dev",
         "education_description":"None",
         "id":21,
         "client":{  
            "slug":"aayulogic",
            "client_name":"Aayulogic",
            "id":3
         },
         "description":null,
         "extra_description":"None",
         "np_image":null
      },
      {  
         "absolute_url":"/service-engineer-2/",
         "education_program":[  

         ],
         "banner":null,
         "categories":[  
            "Secretarial / Front Office / Data Entry"
         ],
         "job_service":{  
            "level":2,
            "service_type":"Premium Job",
            "name":"Hot Job"
         },
         "offered_salary":{  
            "maximum":50000.0,
            "minimum":1000.0,
            "unit":"Monthly",
            "currency":"NRs",
            "operator":null
         },
         "modified_at":"2018-04-26T06:21:10.654613Z",
         "vacancies":10,
         "can_apply_from_mobile":false,
         "job_source":null,
         "job_locations":[  
            {  
               "city":"Kathmandu",
               "country":"Nepal",
               "address":"Kathmandu, Nepal",
               "latitude":27.7172453,
               "longitude":85.3239605,
               "street":"Kathmandu, Nepal"
            }
         ],
         "job_level":"Entry Level",
         "deadline":"2018-06-14T22:35:00Z",
         "slug":"service-engineer-2",
         "education_level":null,
         "posted_at":"2018-04-26T06:21:10.653060Z",
         "specification":null,
         "hide_org_name":false,
         "skills":[

         ],
         "logo":{  
            "image":"default_pp/employer/employer.png",
            "url":"/media/default_pp/employer/employer.png"
         },
         "apply_online_alternative":"None",
         "industry":"Automotive Sales, Support and Service",
         "apply_online":true,
         "posted_date":"2018-04-26",
         "available_for":[  
            "Full Time"
         ],
         "org_alt_description":"",
         "alternate_description":"<p>Manage all the staffs</p><p><br></p>",
         "title":"Service Engineer",
         "education_description":"None",
         "id":29,
         "client":{  
            "slug":"bmw-nepal",
            "client_name":"BMW Nepal",
            "id":5
         },
         "description":null,
         "extra_description":"None",
         "np_image":null
      },
      {  
         "absolute_url":"/top-level/",
         "education_program":[  
            {  
               "degree":{  
                  "id":1,
                  "name":"Masters"
               },
               "status":"Approved",
               "id":1,
               "name":"Master in Business Studies (MBS)"
            }
         ],
         "banner":null,
         "categories":[  
            "Accounting / Finance",
            "Account management"
         ],
         "job_service":{  
            "level":1,
            "service_type":"Premium Job",
            "name":"Top Job"
         },
         "offered_salary":{  
            "maximum":null,
            "minimum":25000.0,
            "unit":"Monthly",
            "currency":"NRs",
            "operator":"Above"
         },
         "modified_at":"2018-04-26T07:50:03.228587Z",
         "vacancies":6,
         "can_apply_from_mobile":false,
         "job_source":null,
         "job_locations":[  
            {  
               "city":null,
               "country":null,
               "address":"",
               "latitude":null,
               "longitude":null,
               "street":null
            }
         ],
         "job_level":"Top Level",
         "deadline":"2018-05-31T07:40:00Z",
         "slug":"top-level",
         "education_level":"Masters",
         "posted_at":"2018-04-26T07:50:03.227375Z",
         "specification":"<p>Must have at least 3 years of experience in related field.</p><p>High level of verbal and written communication skills.</p><p>Should have good knowledge of financial statements.</p><p>Good knowledge of accounting software.</p><p>Both Male and Female are preferable</p>",
         "hide_org_name":false,
         "skills":[  
            "Accounting"
         ],
         "logo":{  
            "image":"default_pp/employer/employer.png",
            "url":"/media/default_pp/employer/employer.png"
         },
         "apply_online_alternative":"None",
         "industry":"Automotive Sales, Support and Service",
         "apply_online":true,
         "posted_date":"2018-04-26",
         "available_for":[  
            "Full Time"
         ],
         "org_alt_description":"",JSON
         "alternate_description":null,
         "title":"top level",
         "education_description":"None",
         "id":30,
         "client":{  
            "slug":"bmw-nepal",
            "client_name":"BMW Nepal",
            "id":5
         },
         "description":"<br><p>o implement good internal control system, establish key control points and schedule monitoring for control assurance</p><p>Preparing balance sheet, cash flow statement, income statement, other periodic statements</p><p>Maintain general ledger by transferring subsidiary accounts, preparing a trial balance, reconciling entries</p><p>Complete external audit by analyzing and scheduling general ledger accounts; providing information for auditors</p><p>Coordinate with other departments to ensure the payment by the customers</p><p>Maintains professional and technical knowledge by attending educational workshops; reviewing professional publications; establishing personal networks; participating in professional societies</p>",
         "extra_description":"None",
         "np_image":null
      },
      {  
         "absolute_url":"/senior-frontend-dev/",
         "education_program":[  

         ],
         "banner":null,
         "categories":[  
            "IT and Telecommunication"
         ],
         "job_service":{  
            "level":1,
            "service_type":"Premium Job",
            "name":"Top Job"
         },
         "offered_salary":{  
            "maximum":null,
            "minimum":20000000.0,
            "unit":"Monthly",
            "currency":"NRs",
            "operator":null
         },
         "modified_at":"2018-05-03T05:36:14.848661Z",
         "vacancies":3,
         "can_apply_from_mobile":false,
         "job_source":null,
         "job_locations":[  
            {  
               "city":null,
               "country":null,
               "address":"",
               "latitude":null,
               "longitude":null,
               "street":null
            }
         ],
         "job_level":"Top Level",
         "deadline":"2018-05-24T11:10:00Z",
         "slug":"senior-frontend-dev",
         "education_level":null,
         "posted_at":"2018-05-03T05:36:14.834194Z",
         "specification":null,
         "hide_org_name":false,
         "skills":[  

         ],
         "logo":{  
            "image":"default_pp/employer/employer.png",
            "url":"/media/default_pp/employer/employer.png"
         },
         "apply_online_alternative":"None",
         "industry":"Telecommunication",
         "apply_online":true,
         "posted_date":"2018-05-03",
         "available_for":[  
            "Full Time"
         ],
         "org_alt_description":"",
         "alternate_description":"Nonesad sad dsa das dsa sda sad asda sd asd sad<br>",
         "title":"Senior Frontend Dev",
         "education_description":"None",
         "id":32,
         "client":{  
            "slug":"aayulogic",
            "client_name":"Aayulogic",
            "id":3
         },
         "description":null,
         "extra_description":"None",
         "np_image":null
      },
      {  
         "absolute_url":"/progress11_developer/",
         "education_program":[  

         ],
         "banner":null,
         "categories":[  
            "IT and Telecommunication"
         ],
         "job_service":{  
            "level":1,
            "service_type":"Premium Job",
            "name":"Top Job"
         },
         "offered_salary":{  
            "maximum":null,
            "minimum":29155.0,
            "unit":"Monthly",
            "currency":"NRs",
            "operator":null
         },
         "modified_at":"2018-05-03T08:31:55.404651Z",
         "vacancies":6,
         "can_apply_from_mobile":false,
         "job_source":null,
         "job_locations":[  
            {  
               "city":"Kathmandu",
               "country":"Nepal",
               "address":"Lalitpur Nepal",
               "latitude":82.0,
               "longitude":81.0,
               "street":"Minbhawan Bus Stop, Kathmandu, Central Region, Nepal, N.K.Singh Marg, Kathmandu, Nepal"
            }
         ],
         "job_level":"Senior Level",
         "deadline":"2018-05-30T08:40:00Z",
         "slug":"progress11_developer",
         "education_level":null,
         "posted_at":"2018-05-03T08:31:55.366559Z",
         "specification":null,
         "hide_org_name":false,
         "skills":[  

         ],
         "logo":{  
            "image":"default_pp/employer/employer.png",
            "url":"/media/default_pp/employer/employer.png"
         },
         "apply_online_alternative":"None",
         "industry":"Automotive Sales, Support and Service",
         "apply_online":true,
         "posted_date":"2018-05-03",
         "available_for":[  
            "Contract"
         ],
         "org_alt_description":"",
         "alternate_description":"Perform all related tasks.",
         "title":"Progress11_Developer",
         "education_description":"None",
         "id":151,
         "client":{  
            "slug":"bmw-nepal",
            "client_name":"BMW Nepal",
            "id":5
         },
         "description":null,
         "extra_description":"None",
         "np_image":null
      },
      {  
         "absolute_url":"/test-detail/",
         "education_program":[  

         ],
         "banner":null,
         "categories":[  
            "Creative / Graphics / Designing"
         ],
         "job_service":{  
            "level":1,
            "service_type":"Premium Job",
            "name":"Top Job"
         },
         "offered_salary":{  
            "maximum":null,
            "minimum":25000.0,
            "unit":"Monthly",
            "currency":"NRs",
            "operator":"Above"
         },
         "modified_at":"2018-05-04T06:19:49.017099Z",
         "vacancies":5,
         "can_apply_from_mobile":false,
         "job_source":null,
         "job_locations":[  
            {  
               "city":"Kathmandu",
               "country":"Nepal",
               "address":"Kathmandu, Nepal",
               "latitude":27.7172453,
               "longitude":85.3239605,
               "street":"Kathmandu, Nepal"
            }
         ],
         "job_level":"Senior Level",
         "deadline":"2018-05-22T23:40:00Z",
         "slug":"test-detail",
         "education_level":null,
         "posted_at":"2018-05-04T06:19:48.988322Z",
         "specification":null,
         "hide_org_name":false,
         "skills":[  

         ],
         "logo":{  
            "image":"default_pp/employer/employer.png",
            "url":"/media/default_pp/employer/employer.png"
         },
         "apply_online_alternative":"None",
         "industry":"Automotive Sales, Support and Service",
         "apply_online":true,
         "posted_date":"2018-05-04",
         "available_for":[  
            "Full Time"
         ],
         "org_alt_description":"",
         "alternate_description":"Job description from UI",
         "title":"Test Detail",
         "education_description":"None",
         "id":185,
         "client":{  
            "slug":"bmw-nepal",
            "client_name":"BMW Nepal",
            "id":5
         },
         "description":null,
         "extra_description":"None",
         "np_image":null
      }
   ]
}
"""

# import json
# original_data = json.loads(datas)
# res_data = original_data.get('results')


# print(f'Length of company data : {len(res_data)} \n')

# from FullcompanyData import a
import json

# original_data = json.loads(datas)
# res_data = original_data.get('results')

class JobJsonParser:

    def __init__(self, *args, **kwargs):

        # initialize required fields
        required_field_list = ['id', 'title', 'categories', 'job_level', 'education_level', 'specification', 'skills', 'client']
        self.skills_list = ['php', 'python', 'js', 'qa']
        self.job_level_list = ['Entry Level', 'Mid Level', 'Senior Level', 'Top Level']
        self.education_level_list = ['+2', 'bachelors', 'masters']

        # get all results from json input. result a list
        # initial_data = args[0].get('results')

        initial_data = args[0]

        # make list of dictinary from all job_data in initial_data on basis of required fields
        self.all_job_dict =[
            {item: temp_data.get(item) for item in required_field_list}\
            for temp_data in initial_data
        ]


    def parse_json(self, single_job_dict):
        
        # create dictionary of skill set with value 1 
        # if job_data has skill set item else 0 for each item
        # skill_dict = {
        #     skill: 0 if not single_job_dict.get('skills')\
        #     else 1 if skill in [temp_skill.lower() for temp_skill in single_job_dict.get('skills')] else 0\
        #     for skill in self.skills_list
        # }


        # quantify job level with the help of index in job_level_list 
        # result list and retrieve first item
        job_level = [
            self.job_level_list.index(single_job_dict.get('job_level'))+1\
            if single_job_dict.get('job_level') else 0
        ][0]


        # quantify job level with the help of index in job_level_list
        # result list and retrieve first item        
        education_level = [
            self.education_level_list.index(single_job_dict.get('education_level').lower())+1\
            if single_job_dict.get('education_level') else 0
        ][0]


        # from experience in specification in html format treat first occuring num as experience
        # experience = [
        #     exp for exp in single_job_dict.get('specification') if exp.isdigit()\
        # ] if single_job_dict.get('specification')  else [0]


        # from experience in specification in html format treat first occuring num as experience
        # instead for making list and looking for all value for experience,
        # use a generator that stops the loop after finding a digit
        # takes iterator and default value
        experience = next(
            (exp for exp in single_job_dict.get('specification') if exp.isdigit()), 0
        ) if single_job_dict.get('specification') else 0

        # create temporary dict to store experience , job_level, education_level, client
        temp_dict = {
            'jobId' :  single_job_dict.get('id'),
            'skills': single_job_dict.get('skills'),
            'jobTitle' :  single_job_dict.get('title'),
            'categories' : single_job_dict.get('categories'),
            'experience' : experience,
            'job_level' : job_level,
            'education_level': education_level,
            'client' : single_job_dict.get('client').get('slug'),
        }

        # return final dict after merging temp_dict with skill_dict
        # return{**temp_dict, **skill_dict}
        return temp_dict

    def get_job_data(self):
        return [self.parse_json(single_object_dict) for single_object_dict in self.all_job_dict]


def read_json(filepath='FullcompanyData.json'):
    with open('FullcompanyData.json', 'r') as jsonfile:
        json_data = jsonfile.read()
        return json.loads(json_data)
    
a = read_json()

parser_obj = JobJsonParser(a)
job_data = parser_obj.get_job_data()

cat = { d.get('categories')[0] for d in job_data}

cat_list = list(cat)


import pandas as pd

for i in range(len(cat_list)):
    a = [list(filter(lambda x:x.get('categories')[0] == cat_list[i], job_data))]
    name = cat_list[i].split(' /')[0]
    df = pd.DataFrame(a)
    df.to_csv(f'../newData/{name}.csv')


""" {'Accounting / Finance', 'Hospitality', 'NGO / INGO / Social work', 'Research and Development', 'Sales / Public Relations', '
Teaching / Education', 'Creative / Graphics / Designing', 'Human Resource / Org. Development', 'Construction / Engineering /
Architects', 'Legal Services', 'IT and Telecommunication', 'Administration', 'Banking / Insurance / Financial Services', 'Acc
ount management', 'Secretarial / Front Office / Data Entry', 'Architecture / Interior Designing', 'Journalism / Editor / Medi
a', 'Commercial / Logistics / Supply Chain', 'Fashion / Textile Designing', 'Healthcare / Pharma / Biotech / Medical / Resear
ch and Development', 'Production / Maintenance / Quality', 'Protective / Security Services', 'Others', 'Marketing / Advertisi
ng / Customer Service', 'General Mgmt. / Administration / Operations'} """



# df = pd.read_json('FullcompanyData.json')
# print(df.head())
# df = pd.DataFrame(final_job_data)

# print(job_data)

usr_dict = {'id': 29, 'title': 'Service Engineer', 'slug': 'service-engineer-2',
'client': {'slug': 'bmw-nepal', 'client_name': 'BMW Nepal', 'id': 5},
'categories': ['Secretarial / Front Office / Data Entry'],
'description': None, 'specification': None,
'alternate_description': '<p>Manage all the staffs</p><p><br></p>',
'skills': [], 'available_for': ['Full Time'],
'job_level': 'Entry Level', 'vacancies': 10,
'deadline': '2018-06-14T22:35:00Z',
'job_service': {'name': 'Hot Job', 'service_type': 'Premium Job', 'level': 2},
'job_source': None, 'np_image': None, 'education_program': [],
'education_level': None, 'education_description': 'None',
'offered_salary': {'currency': 'NRs', 'operator': None, 'minimum': 1000.0, 'unit': 'Monthly', 'maximum': 50000.0}, 'job_locations': [{'address': 'Kathmandu, Nepal', 'street': 'Kathmandu, Nepal', 'city': 'Kathmandu', 'country': 'Nepal', 'latitude': 27.7172453, 'longitude': 85.3239605}], 'hide_org_name': False, 'modified_at': '2018-04-26T06:21:10.956458Z', 'posted_at': '2018-04-26T06:21:10.653060Z', 'posted_date': '2018-04-26', 'apply_online': True, 'status': 'Published', 'apply_online_alternative': 'None', 'extra_description': 'None', 'org_alt_description': '', 'absolute_url': '/service-engineer-2/', 'industry': 'Automotive Sales, Support and Service', 'can_apply_from_mobile': False, 'logo': {'url': '/media/default_pp/employer/employer.png', 'image': 'default_pp/employer/employer.png'},
'banner': None}